---
title: "KAMERA 資料挑戰賽戰報"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, comment = "", message=FALSE)
```

## 最終成績 (前六名)
- 已移除spam
- 完成名單，請參見本報告最末
```{r results='asis'}
dat <- read.csv("KAMERA參賽者(排除spam).csv", fileEncoding = "big5")
library(ggplot2)
library(dplyr)
library(knitr)
filter(dat, Rank<=6) %>% 
  select(Order, Rank, team_name, FullName, 分數) %>%
  setNames(c("流水號", "名次", "隊伍名稱", "隊員名稱","分數")) %>%
  kable()
```

## 成績統計
### 成績分布
- 參賽隊伍91隊(包含100位參賽者)
- 96.4分以下為後段班
- 98.5分以上為前段班

```{r}
dat1 <- select(dat, Rank, team_name, 分數, 上傳次數) %>%
  setNames(c("Rank", "Team", "Score", "Freq")) %>%
  distinct() %>%
  mutate(cut_score=cut(Score, breaks = c(0,85,96.4,98.5,100), right = F))
ggplot(dat1, aes(cut_score)) + geom_bar()

dat1 %>% filter(Score>=96) %>%
  ggplot(., aes(Score, fill=cut_score)) + geom_histogram(bins=20)
```

### 上傳次數
- 不活躍隊伍共25隊 (上傳次數少於2次)。
- 前六名的隊伍上傳次數至少30次
- 上傳次數越多，最終成績越高

```{r}
dat1 <- dat1 %>% 
  mutate(cut_freq=cut(Freq, breaks = c(0,3,6,15,30,70), right = F))
ggplot(dat1, aes(cut_freq)) + geom_bar()

dat1 %>% filter(Score>=96, Freq>6) %>%
  ggplot(., aes(x=Freq, y=Score)) + geom_point() + stat_smooth()
```


### 前三名戰況
```{r}
p1 <- data.frame(name="b10009047",
                        date=c("2016-02-29","2016-03-02","2016-03-03","2016-03-05","2016-03-06","2016-03-07","2016-03-08","2016-03-09","2016-03-10","2016-03-11","2016-03-12","2016-03-13","2016-03-14","2016-03-15","2016-03-18","2016-03-21","2016-03-22","2016-04-07","2016-04-08","2016-04-09","2016-04-10"),
                        score=c(0,71.69,94.843,79.5395,97.42,97.863,97.62,98.1205,97.774,98.6625,98.822,98.808,98.8745,98.82,98.789,98.8215,97.9995,98.605,98.972,99.0755,99.0755))

p2 <- data.frame(name="cmchen",
                 date=c("2016-02-19","2016-02-20","2016-02-21","2016-02-23","2016-02-25","2016-02-26","2016-03-05","2016-03-07","2016-03-10","2016-03-11","2016-03-12","2016-03-13","2016-03-14","2016-03-15","2016-03-16","2016-03-17","2016-03-18","2016-03-19","2016-03-20","2016-03-24","2016-03-25","2016-03-28","2016-03-29","2016-03-30","2016-03-31","2016-04-01","2016-04-02","2016-04-03","2016-04-04","2016-04-05","2016-04-06","2016-04-07","2016-04-08","2016-04-09","2016-04-10"),
                 score=c(0,97.5055,97.322,98.078,98.082,98.082,98.56,98.759,98.716,98.7425,98.756,98.727,98.618,98.709,98.932,98.8835,98.917,98.916,98.8455,98.8615,98.9255,98.881,98.2195,98.936,98.2495,98.303,98.1645,98.845,98.9915,98.8925,99.022,98.918,99.0355,99.044,99.0235))


p3 <- data.frame(name="yi",
                 date=c("2016-03-16","2016-03-17","2016-03-18","2016-03-21","2016-03-22","2016-03-23","2016-03-24","2016-03-25","2016-03-26","2016-03-27","2016-03-28","2016-03-29","2016-03-30","2016-03-31","2016-04-01","2016-04-02","2016-04-03","2016-04-05","2016-04-06","2016-04-07","2016-04-08","2016-04-09","2016-04-10"),
                 score=c(97.548,97.311,97.32,98.127,98.127,98.617,98.4965,98.2235,98.613,98.5385,98.6695,97.576,98.789,98.7735,98.76,98.8185,98.8135,98.859,98.7755,98.0635,98.527,98.841,98.879))

p4 <- data.frame(name="lan",
                 date=c("2016-03-29","2016-03-31","2016-04-06","2016-04-07","2016-04-09","2016-04-10"),
                 score=c(0,97.698,97.443,98.396,98.396,98.394))

p5 <- data.frame(name="Carl",
                 date=c("2016-03-02","2016-03-03","2016-03-04","2016-03-05","2016-03-14","2016-03-15","2016-03-16","2016-03-17","2016-03-18","2016-03-19","2016-03-20","2016-03-21","2016-03-22","2016-03-23","2016-03-24","2016-03-25","2016-03-26","2016-03-27","2016-03-28","2016-03-29","2016-03-30","2016-03-31","2016-04-01","2016-04-02","2016-04-03","2016-04-04","2016-04-05","2016-04-06","2016-04-07","2016-04-08","2016-04-09","2016-04-10"),
                 score=c(97.373,97.3735,97.57,97.9725,79.1815,97.9115,98.157,97.8275,98.202,98.241,98.207,98.265,98.242,98.376,98.3875,98.44,98.5085,98.505,98.5845,98.687,98.71,98.729,98.7145,98.7695,98.798,98.7945,98.808,98.812,98.822,98.8345,98.84,98.846))

p6 <- data.frame(name="CHHsu",
                 date=c("2016-03-01","2016-03-02","2016-03-03","2016-03-07","2016-03-08","2016-03-09","2016-03-10","2016-03-11","2016-03-12","2016-03-13","2016-03-14","2016-03-15","2016-03-16","2016-03-17","2016-03-19","2016-03-20","2016-03-21","2016-03-22","2016-03-23","2016-03-26","2016-03-28","2016-03-31","2016-04-01","2016-04-02","2016-04-03","2016-04-04","2016-04-06","2016-04-07","2016-04-08","2016-04-09"),
                 score=c(0,0,0,0,0,40.3545,86.1325,97.3585,97.788,97.0275,84.327,97.9415,98.063,98.17,98.019,97.639,98.4455,98.384,98.501,96.799,98.2665,97.861,92.7935,67.2305,94.275,95.53,98.1305,98.164,97.6715,98.501))

#library(plotly)

dat2 <- rbind(p1,p2,p3,p4,p5,p6)
dat2 <- rbind(p1,p2,p3)
dat2$date <- as.Date(dat2$date)
dat2 <- filter(dat2, score >= 97.5)                     
g <- ggplot(dat2, aes(x=date, y=score, color=name)) + geom_step(lwd=1) +
  ylim(97.5,99.2) + theme(text=element_text(size=16))
#ggplotly(g)
g
```

### 最終成績 (完整版)
```{r results='asis'}
arrange(dat, Rank) %>% 
  select(Order, Rank, team_name, FullName, 分數) %>%
  setNames(c("流水號", "名次", "隊伍名稱", "隊員名稱","分數")) %>%
  kable()
```

